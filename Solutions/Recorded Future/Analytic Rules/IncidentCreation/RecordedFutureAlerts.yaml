id: 0aded97e-4e2d-4e4d-93cf-4a7e45c7bab3
name: Recorded Future Alerts Incident Creation
description: |
  'Create Recorded Future Alerts in Microsoft Defender'
severity: Medium
status: Available
requiredDataConnectors:
  - connectorId: RecordedFuture
    dataTypes:
      - RecordedFuturePortalAlerts_CL
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics: []
relevantTechniques: []
query: |
  RecordedFuturePortalAlerts_CL
  | where TimeGenerated >= now(-1h)
eventGroupingSettings:
  aggregationKind: AlertPerResult
alertDetailsOverride:
  alertDisplayNameFormat: 'Alert: {{AlertName_s}}'
  alertDescriptionFormat: |
    _Recorded Future Alert_

    AlertID:
    {{AlertID_s}}

    Triggered: {{Triggered_t}}

    AI Summary: {{AISummary_s}}
  alertDynamicProperties:
    - alertProperty: AlertLink
      value: URL_s
customDetails:
  RFLabel: SourceSystem
  RuleName: RuleName_s
  RuleId: RuleId_s
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: 1h
    matchingMethod: Selected
    groupByEntities: []
    groupByAlertDetails: []
    groupByCustomDetails:
      - RuleId
version: 1.0.0
kind: NRT
