id: a1b2c3d4-5678-90ab-cdef-111111111111
name: Recorded Future Sandbox - Malicious File Detected
description: |
  'Creates incidents when Recorded Future Sandbox detects malicious files from Storage Account or Outlook attachments'
severity: High
status: Available
requiredDataConnectors:
  - connectorId: RecordedFuture
    dataTypes:
      - RecordedFutureSandboxResults_CL
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - Execution
  - InitialAccess
relevantTechniques:
  - T1204
  - T1566
query: |
  RecordedFutureSandboxResults_CL
  | where TimeGenerated >= now(-1h)
  | where toint(SandboxScore_s) >= 50
eventGroupingSettings:
  aggregationKind: AlertPerResult
alertDetailsOverride:
  alertDisplayNameFormat: 'Recorded Future Sandbox: Malicious File - {{FileName_s}}'
  alertDescriptionFormat: |
    _Recorded Future Sandbox Analysis_

    **File Name:** {{FileName_s}}

    **Sandbox Score:** {{SandboxScore_s}}/100

    **Verdict:** {{SandboxVerdict_s}}

    **Source:** {{Source_s}}

    **Sample ID:** {{SampleId_s}}

    **Scan Time:** {{ScanTime_t}}

    Review the full sandbox report for detailed analysis.
  alertDynamicProperties: []
customDetails:
  RFLabel: SourceSystem
  Source: Source_s
  SandboxScore: SandboxScore_s
  SandboxVerdict: SandboxVerdict_s
  FileName: FileName_s
  SampleId: SampleId_s
entityMappings:
  - entityType: File
    fieldMappings:
      - identifier: Name
        columnName: FileName_s
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: false
    lookbackDuration: 1h
    matchingMethod: Selected
    groupByEntities: []
    groupByAlertDetails: []
    groupByCustomDetails:
      - Source
version: 1.0.0
kind: NRT
